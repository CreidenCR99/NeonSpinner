<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <title>Neon Spinner</title>
    
        <style>
        body {
            margin: 0;
            overflow: hidden;
            background: #05050a;
            font-family: Impact, Haettenschweiler, 'Arial Narrow Bold', sans-serif;
        }
        #stars {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            z-index: -1;
            display: block;
            pointer-events: none;
        }

        #FPS {
            color: #00eaff44;
            font-size: 2rem;
            position: absolute;
            margin: auto;
            font-size: medium;
            transition: 0.1s;
            right: 0px;
            top: 35px;
            z-index: 50;
        }

        #progress-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 18px;
            background: rgba(10, 20, 40, 0.85);
            z-index: 30;
            box-shadow: 0 2px 18px #00eaff44;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        #progress-bar {
            height: 7px;
            border-radius: 8px;
            background: linear-gradient(90deg, #00eaff 60%, #00b6c9 100%);
            box-shadow: 0 0 12px #00eaff99;
            width: 0%;
            transition: width 0.25s cubic-bezier(.23, 1.12, .32, 1), box-shadow 0.2s;
            margin-right: 0;
            flex-shrink: 0;
            animation: none;
        }

        #progress-bar.animated {
            animation: progress-pop 0.25s;
        }

        @keyframes progress-pop {
            0% {
                box-shadow: 0 0 24px #00eaffcc, 0 0 8px #00eaff99;
            }

            100% {
                box-shadow: 0 0 12px #00eaff99;
            }
        }

        #score-record {
            position: fixed;
            top: 22px;
            left: 0;
            width: 100vw;
            display: flex;
            gap: 32px;
            align-items: center;
            justify-content: center;
            z-index: 31;
        }

        #score,
        #record {
            position: static;
            font-size: 1.3rem;
            color: #00eaff;
            text-shadow: 0 0 10px #00eaff;
            display: inline;
            margin: 0 8px;
        }

        #score {
            top: 0;
            left: 0;
            z-index: 10;
        }

        #record {
            top: 0;
            right: 0;
            z-index: 10;
        }

        #gameover {
            position: absolute;
            top: 40%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: white;
            text-align: center;
            font-size: 3rem;
            display: none;
            z-index: 10;
            user-select: none;
        }

        #retry {
            margin-top: 20px;
            padding: 14px 28px;
            font-size: 1.3rem;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            background: #00eaff;
            color: white;
            font-weight: bold;
        }

        #backmenu {
            margin-top: 10px;
            padding: 12px 24px;
            font-size: 1.2rem;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            background: #ff4081;
            color: white;
            font-weight: bold;
        }

        #CambiarSkin {
            margin-top: 10px;
            padding: 12px 24px;
            font-size: 1.2rem;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            background: #40ff89;
            color: white;
            font-weight: bold;
        }

        /* --- Main Menu Neon Style & Animations --- */
        #mainmenu {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) scale(0.95);
            background: rgba(10, 20, 40, 0.97);
            border-radius: 30px;
            padding: 60px 70px 50px 70px;
            text-align: center;
            z-index: 20;
            min-width: 340px;
            box-shadow:
                0 0 60px #00eaff99,
                0 0 10px #00eaff55,
                0 0 0 4px #00eaff22 inset;
            color: #fff;
            display: block;
            animation: menu-pop 1s cubic-bezier(.23, 1.12, .32, 1) forwards;
        }

        @keyframes menu-pop {
            0% {
                opacity: 0;
                transform: translate(-50%, -60%) scale(0.8);
                filter: blur(8px);
            }

            60% {
                opacity: 1;
                transform: translate(-50%, -48%) scale(1.05);
                filter: blur(0);
            }

            100% {
                opacity: 1;
                transform: translate(-50%, -50%) scale(1);
                filter: blur(0);
            }
        }

        #mainmenu h1 {
            font-size: 3.2rem;
            color: #00eaff;
            margin-bottom: 35px;
            text-shadow:
                0 0 25px #00838f,
                0 0 8px #00838f,
                0 0 2px #fff;
            letter-spacing: 2px;
            animation: neon-glow 2s infinite alternate;
        }

        @keyframes neon-glow {

            0%,
            25% {
                text-shadow:
                    0 0 25px #00838f,
                    0 0 8px #00838f,
                    0 0 2px #fff;
            }

            100% {
                text-shadow:
                    0 0 40px #00eaff,
                    0 0 16px #00eaff,
                    0 0 8px #fff;
            }
        }

        #mainmenu button {
            margin: 20px 0;
            padding: 18px 48px;
            font-size: 1.5rem;
            border: none;
            border-radius: 14px;
            cursor: pointer;
            background: linear-gradient(90deg, #00eaff 60%, #00b6c9 100%);
            color: #05050a;
            font-weight: bold;
            box-shadow:
                0 0 18px #00eaff99,
                0 0 4px #00eaff55;
            transition: background 0.2s, transform 0.15s, box-shadow 0.2s;
            outline: none;
            position: relative;
            overflow: hidden;
            animation: button-fadein 1.2s cubic-bezier(.23, 1.12, .32, 1) 0.2s backwards;
        }

        @keyframes button-fadein {
            0% {
                opacity: 0;
                transform: translateY(30px) scale(0.95);
            }

            100% {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        #mainmenu button:enabled:hover {
            background: linear-gradient(90deg, #00b6c9 60%, #00eaff 100%);
            transform: scale(1.07);
            box-shadow:
                0 0 30px #00eaffcc,
                0 0 8px #00eaff99;
        }

        #mainmenu button:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            background: #222c;
            color: #aaa;
            box-shadow: none;
        }

        #mainmenu .comingsoon {
            margin-top: 12px;
            font-size: 1.15rem;
            color: #aaa;
            opacity: 0.7;
            letter-spacing: 1px;
            animation: fadein 2s 1.2s backwards;
        }

        @keyframes fadein {
            from {
                opacity: 0;
                transform: translateY(10px);
            }

            to {
                opacity: 0.7;
                transform: translateY(0);
            }
        }

        /* Neon border animation */
        #mainmenu::before {
            content: "";
            position: absolute;
            inset: -6px;
            border-radius: 36px;
            z-index: -1;
            pointer-events: none;
            /* X shape using two gradients */
            background:
                linear-gradient(45deg, #00eaff 0%, #00eaff 20%, transparent 20%, transparent 80%, #00eaff 80%, #00eaff 100%),
                linear-gradient(-45deg, #00b6c9 0%, #00b6c9 20%, transparent 20%, transparent 80%, #00b6c9 80%, #00b6c9 100%);
            filter: blur(10px) brightness(1.3);
            opacity: 0.7;
            animation: border-rotate 4s linear infinite;
        }

        @keyframes border-rotate {
            0% {
                transform: rotate(0deg);
            }

            100% {
                transform: rotate(360deg);
            }
        }
    </style>
</head>

<body>
    <canvas id="stars"></canvas>
    <h1 id="FPS"></h1>
    <div id="progress-container">
        <div id="progress-bar"></div>
    </div>
    <div id="score-record">
        <span id="score">Puntos: 0</span>
        <span id="record">RÃ©cord: 0</span>
    </div>
    <div id="mainmenu">
        <h1>Neon Spinner</h1>
        <button id="playbtn">Jugar</button>
        <br>
        <button id="shopbtn" disabled>Tienda</button>
        <div class="comingsoon">(v2.2)</div>
    </div>
    <div id="gameover">
        GAME OVERðŸ«¤
        <br>
        <button id="retry">Reintentar</button>
        <button id="backmenu">Volver al menÃº</button>
        <br>
        <button onclick="setRandomSkin();" id="CambiarSkin">Cambiar Skin</button>
    </div>
    <canvas style="cursor: none;" id="game"></canvas>

    <script>

        var godMone = false;

        const canvas = document.getElementById("game");
        const ctx = canvas.getContext("2d");

        canvas.width = innerWidth;
        canvas.height = innerHeight;

        let score = 0;
        let playing = false;
        let projectileSpeed = 15;

        let player = { x: canvas.width / 2, y: canvas.height / 2, r: 25, angle: 0 };
        let projectiles = [];

        // Leer rÃ©cord guardado
        let record = localStorage.getItem("neonSpinnerRecord") || 0;
        document.getElementById("record").innerText = "RÃ©cord: " + record;

        document.addEventListener("mousemove", e => {
            if (!playing) return;
            player.x = e.clientX;
            player.y = e.clientY;
        });

        function spawnProjectile() {
            if (!playing) return;

            const side = Math.floor(Math.random() * 4);
            let x, y;
            if (side === 0) { x = Math.random() * canvas.width; y = -30; }
            else if (side === 1) { x = canvas.width + 30; y = Math.random() * canvas.height; }
            else if (side === 2) { x = Math.random() * canvas.width; y = canvas.height + 30; }
            else { x = -30; y = Math.random() * canvas.height; }

            const angle = Math.atan2(player.y - y, player.x - x);

            projectiles.push({
                x, y,
                vx: Math.cos(angle) * projectileSpeed,
                vy: Math.sin(angle) * projectileSpeed,
                r: 14 + Math.random() * 11,
                color: `hsl(${Math.random() * 360}, 100%, 60%)`
            });

            setTimeout(spawnProjectile, 250 + Math.random() * 250);
        }

        // Lista de letras posibles para la skin
        const playerSkins = ["x", "o", "A", "D", "Y", "S", "Z", "W", "V", "T", "L", "I", "67"];
        let currentSkin = playerSkins[Math.floor(Math.random() * playerSkins.length)];

        function drawPlayer() {
            player.angle += 0.12;

            ctx.save();
            ctx.translate(player.x, player.y);
            ctx.rotate(player.angle);

            ctx.strokeStyle = "#00eaff";
            ctx.lineWidth = 2;
            ctx.shadowBlur = 20;
            ctx.shadowColor = "#00eaff";

            // Dibuja la letra correspondiente como skin
            ctx.font = "100px 'Press Start 2P', 'VT323', 'Orbitron', monospace";
            ctx.textAlign = "center";
            ctx.textBaseline = "middle";
            ctx.strokeText(currentSkin, 0, 0);
            ctx.fillStyle = "#00eaff";
            ctx.globalAlpha = 0.15;
            ctx.fillText(currentSkin, 0, 0);
            ctx.globalAlpha = 1;

            ctx.restore();
        }

        // Cambia la skin al iniciar/reintentar partida
        function setRandomSkin() {
            let newSkin;
            do {
                newSkin = playerSkins[Math.floor(Math.random() * playerSkins.length)];
            } while (newSkin === currentSkin && playerSkins.length > 1);
            currentSkin = newSkin;
        }

        function drawProjectiles() {
            ctx.save();
            ctx.globalAlpha = 0.05;
            ctx.fillStyle = "#05050a";
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            ctx.restore();

            for (let i = projectiles.length - 1; i >= 0; i--) {
                const p = projectiles[i];
                p.x += p.vx;
                p.y += p.vy;

                ctx.beginPath();
                ctx.arc(p.x, p.y, p.r, 0, Math.PI * 2);
                ctx.fillStyle = p.color;
                ctx.shadowBlur = 20;
                ctx.shadowColor = p.color;
                ctx.fill();

                const dx = p.x - player.x;
                const dy = p.y - player.y;
                if (Math.hypot(dx, dy) < p.r + player.r) {
                    endGame();
                }

                if (p.x < -50 || p.x > canvas.width + 50 || p.y < -50 || p.y > canvas.height + 50) {
                    projectiles.splice(i, 1);
                    score++;
                    projectileSpeed += 0.05;
                    const scoreElem = document.getElementById("score");
                    scoreElem.innerText = "Puntos: " + score;
                    updateProgressBar();

                    // Score animation
                    scoreElem.style.transition = "none";
                    scoreElem.style.transform = "scale(1.3)";
                    setTimeout(() => {
                        scoreElem.style.transition = "transform 0.2s";
                        scoreElem.style.transform = "scale(1)";
                    }, 10);

                    if (score > record) {
                        record = score;
                        const recordElem = document.getElementById("record");
                        recordElem.innerText = "RÃ©cord: " + record;
                        localStorage.setItem("neonSpinnerRecord", record);

                        // Record animation
                        recordElem.style.transition = "none";
                        recordElem.style.transform = "scale(1.3)";
                        setTimeout(() => {
                            recordElem.style.transition = "transform 0.2s";
                            recordElem.style.transform = "scale(1)";
                        }, 10);
                    }
                }
            }
        }

        function endGame() {
            if (godMone == true) {
                return;
            } else {
                playing = false;
                document.getElementById("gameover").style.display = "block";
                document.getElementById("game").style.cursor = "auto";
            }
        }

        function update() {
            if (!playing) return;

            ctx.clearRect(0, 0, canvas.width, canvas.height);
            drawPlayer();
            drawProjectiles();

            requestAnimationFrame(update);
        }

        document.getElementById("retry").onclick = () => {
            // Reiniciar el juego sin recargar la pÃ¡gina
            score = 0;
            projectileSpeed = 15;
            projectiles = [];
            player = { x: canvas.width / 2, y: canvas.height / 2, r: 25, angle: 0 };
            document.getElementById("score").innerText = "Puntos: 0";
            document.getElementById("gameover").style.display = "none";
            document.getElementById("game").style.cursor = "none";
            playing = true;
            spawnProjectile();
            update();
            updateProgressBar();
        };

        document.getElementById("backmenu").onclick = () => location.reload();

        document.getElementById("playbtn").onclick = () => {
            document.getElementById("mainmenu").style.display = "none";
            document.getElementById("score").style.display = "inline";
            document.getElementById("record").style.display = "inline";
            playing = true;
            spawnProjectile();
            update();
            updateProgressBar();
        };

        document.getElementById("shopbtn").onclick = () => {
            // Futuro: abrir tienda
            alert("Â¡La tienda estarÃ¡ disponible prÃ³ximamente!");
        };

        var startTime = Date.now();
        var frame = 0;
        function tick() {
            var time = Date.now();
            frame++;
            if (time - startTime > 1000) {
                document.getElementById("FPS").innerHTML = (frame / ((time - startTime) / 1000)).toFixed(2) + " FPS";
                startTime = time;
                frame = 0;
            };
            window.requestAnimationFrame(tick);
        };
        tick();

        // Progreso barra
        function updateProgressBar() {
            const bar = document.getElementById("progress-bar");
            let percent = Math.min(score, 100) / 100 * 100;
            bar.style.width = percent + "%";
            bar.classList.remove("animated");
            void bar.offsetWidth; // trigger reflow
            bar.classList.add("animated");
        }

        // Sparkling stars background
        const starsCanvas = document.getElementById('stars');
        const starsCtx = starsCanvas.getContext('2d');
        let sw = window.innerWidth;
        let sh = window.innerHeight;
        starsCanvas.width = sw;
        starsCanvas.height = sh;
        function randomStar() {
            return {
                x: Math.random() * sw,
                y: Math.random() * sh,
                radius: Math.random() * 1.2 + 0.2,
                alpha: Math.random(),
                dx: (Math.random() - 0.5) * 0.2,
                dy: (Math.random() - 0.5) * 0.2,
                dAlpha: (Math.random() - 0.5) * 0.02
            };
        }
        let starsArr = Array.from({length: 120}, randomStar);
        function drawStars() {
            starsCtx.clearRect(0, 0, sw, sh);
            for (let star of starsArr) {
                starsCtx.save();
                starsCtx.globalAlpha = Math.abs(star.alpha);
                starsCtx.beginPath();
                starsCtx.arc(star.x, star.y, star.radius, 0, 2 * Math.PI);
                starsCtx.fillStyle = "#fff";
                starsCtx.shadowColor = "#fff";
                starsCtx.shadowBlur = 8;
                starsCtx.fill();
                starsCtx.restore();
                star.x += star.dx;
                star.y += star.dy;
                star.alpha += star.dAlpha;
                if (star.alpha < 0.1 || star.alpha > 1) star.dAlpha *= -1;
                if (star.x < 0 || star.x > sw || star.y < 0 || star.y > sh) {
                    Object.assign(star, randomStar());
                }
            }
            requestAnimationFrame(drawStars);
        }
        window.addEventListener('resize', () => {
            sw = window.innerWidth;
            sh = window.innerHeight;
            starsCanvas.width = sw;
            starsCanvas.height = sh;
        });
        drawStars();
    </script>

</body>

</html>