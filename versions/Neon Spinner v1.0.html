<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Neon Spinner</title>
<style>
    body {
        margin: 0;
        overflow: hidden;
        background: #05050a;
    }

    #score {
        position: absolute;
        top: 20px;
        left: 20px;
        z-index: 10;
        color: #00eaff;
        font-size: 2rem;
        text-shadow: 0 0 10px #00eaff;
        user-select: none;
    }

    #gameover {
        position: absolute;
        top: 40%;
        left: 50%;
        transform: translate(-50%, -50%);
        color: white;
        text-align: center;
        font-size: 3rem;
        display: none;
        z-index: 10;
        user-select: none;
    }

    #retry {
        margin-top: 20px;
        padding: 14px 28px;
        font-size: 1.3rem;
        border: none;
        border-radius: 10px;
        cursor: pointer;
        background: #00eaff;
        color: black;
        font-weight: bold;
    }
</style>
</head>
<body>


<div id="score">Puntos: 0</div>
<div id="record">RÃ©cord: 0</div> <!-- Nuevo contador -->
<div id="gameover">
    GAME OVERðŸ«¤
    <br>
    <button id="retry">Reintentar</button>
</div>
<canvas id="game"></canvas>

<style>
#score, #record {
    position: absolute;
    top: 20px;
    left: 20px;
    z-index: 10;
    color: #00eaff;
    font-size: 2rem;
    text-shadow: 0 0 10px #00eaff;
    user-select: none;
}
#record {
    top: 60px; /* Debajo de puntos */
}
</style>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

canvas.width = innerWidth;
canvas.height = innerHeight;

let score = 0;
let playing = true;
let projectileSpeed = 15;

let player = { x: canvas.width/2, y: canvas.height/2, r: 25, angle: 0 };
let projectiles = [];

// Leer rÃ©cord guardado
let record = localStorage.getItem("neonSpinnerRecord") || 0;
document.getElementById("record").innerText = "RÃ©cord: " + record;

document.addEventListener("mousemove", e => {
    player.x = e.clientX;
    player.y = e.clientY;
});

function spawnProjectile() {
    if (!playing) return;

    const side = Math.floor(Math.random()*4);
    let x, y;
    if(side===0){ x=Math.random()*canvas.width; y=-30; }
    else if(side===1){ x=canvas.width+30; y=Math.random()*canvas.height; }
    else if(side===2){ x=Math.random()*canvas.width; y=canvas.height+30; }
    else{ x=-30; y=Math.random()*canvas.height; }

    const angle = Math.atan2(player.y - y, player.x - x);

    projectiles.push({
        x, y,
        vx: Math.cos(angle)*projectileSpeed,
        vy: Math.sin(angle)*projectileSpeed,
        r: 18,
        color: `hsl(${Math.random()*360}, 100%, 60%)`
    });

    setTimeout(spawnProjectile, 250 + Math.random()*250);
}

function drawPlayer() {
    player.angle += 0.12;

    ctx.save();
    ctx.translate(player.x, player.y);
    ctx.rotate(player.angle);

    ctx.strokeStyle = "#00eaff";
    ctx.lineWidth = 8;
    ctx.shadowBlur = 20;
    ctx.shadowColor = "#00eaff";

    ctx.beginPath();
    ctx.moveTo(-35, 0); ctx.lineTo(35, 0);
    ctx.stroke();

    ctx.beginPath();
    ctx.moveTo(0, -35); ctx.lineTo(0, 35);
    ctx.stroke();

    ctx.restore();
}

function drawProjectiles() {
    for(let i = projectiles.length - 1; i >= 0; i--) {
        const p = projectiles[i];
        p.x += p.vx;
        p.y += p.vy;

        ctx.beginPath();
        ctx.arc(p.x, p.y, p.r, 0, Math.PI*2);
        ctx.fillStyle = p.color;
        ctx.shadowBlur = 20;
        ctx.shadowColor = p.color;
        ctx.fill();

        const dx = p.x - player.x;
        const dy = p.y - player.y;
        if(Math.hypot(dx, dy) < p.r + player.r) {
            endGame();
        }

        if(p.x < -50 || p.x > canvas.width+50 || p.y < -50 || p.y > canvas.height+50){
            projectiles.splice(i,1);
            score++;
            projectileSpeed += 0.05;
            document.getElementById("score").innerText = "Puntos: " + score;

            // Actualizar rÃ©cord si se supera
            if(score > record){
                record = score;
                document.getElementById("record").innerText = "RÃ©cord: " + record;
                localStorage.setItem("neonSpinnerRecord", record);
            }
        }
    }
}

function endGame() {
    playing = false;
    document.getElementById("gameover").style.display = "block";
}

function update() {
    if(!playing) return;

    ctx.clearRect(0,0,canvas.width,canvas.height);
    drawPlayer();
    drawProjectiles();
    requestAnimationFrame(update);
}

document.getElementById("retry").onclick = () => location.reload();

spawnProjectile();
update();
</script>

</body>
</html>